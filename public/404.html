<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Redirecting...</title>
    <script>
      (function () {
        // Try to fetch index.html from candidate locations so SPA can bootstrap for deep links.
        function tryFetchIndex(path) {
          return fetch(path, { cache: 'no-store' }).then(function (res) {
            if (res.status === 200) return res.text();
            return null;
          });
        }

        var pathname = location.pathname || '/';
        var segments = pathname.split('/').filter(function (s) { return s.length > 0; });
        var candidates = ['/index.html'];
        for (var i = 0; i < segments.length; i++) {
          candidates.push('/' + segments.slice(0, i + 1).join('/') + '/index.html');
        }

        (function tryNext(i) {
          if (i >= candidates.length) {
            window.location.replace('/');
            return;
          }

          tryFetchIndex(candidates[i]).then(function (html) {
            if (html) {
              document.open();
              document.write(html);
              document.close();
              history.replaceState({}, '', location.pathname + location.search + location.hash);
            } else {
              tryNext(i + 1);
            }
          }).catch(function () {
            tryNext(i + 1);
          });
        })(0);
      })();
    </script>
  </head>
  <body>
    Redirecting to the app...
  </body>
</html>
